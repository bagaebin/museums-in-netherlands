# 인터랙션 상세 스펙

## 사물함 드래그
- 각 `Locker`는 `drag` 옵션을 가진 모션 `<div>`로 구현되어 포인터/터치 드래그를 지원한다.
- 드래그 중 위치가 `positions` 상태에 즉시 반영되어 관계 곡선이 실시간 업데이트된다.

## 치즈 곡선 생성/업데이트
- 두 사물함이 떨어질 때 `computePathPoints`가 시작/종점 사이에 부드러운 cubic Bézier를 생성한다.
- 시작점은 출발 사물함의 오른쪽 중앙, 종점은 대상 사물함의 왼쪽 중앙을 기본값으로 삼는다.
- 거리가 멀어질수록 제어점 오프셋(`curve = 80`)이 상대적으로 더 드러나 부드러운 "늘어짐" 효과가 발생한다.
- 관계선은 스테이지 실측 크기를 기반으로 `viewBox`를 동적으로 설정한 SVG(`width/height: 100%`) 위에 그려, 리사이즈나 레이아웃 전환 후에도 사물함 모서리와 정확히 맞닿는다.

## 관계 텍스트 등장 로직
- `estimateReveal`가 거리와 최대 임계값(기본 280px)을 비교해 라벨을 글자 단위로 절단한다.
- `textPath` 안에 잘린 문자열을 넣어, 곡선이 늘어날수록 더 많은 글자가 노출된다.

## 사물함 문 애니메이션
- 클릭으로 문을 연다(`onOpen`), 열린 동안에만 내부/배경/콘텐츠가 `open` 상태로 전환된다.
- `doorVariants`에 따라 `rotateY`를 -90°까지 회전하며, `transformOrigin: 'left center'`로 힌지 효과를 준다.
- 트랜지션은 spring(stiffness: 200, damping: 20)으로 설정해 메커니컬한 느낌을 강화.

## 내부 배경 레이어
- 기본 배경(`--detail-base`)은 문이 닫혀 있을 때부터 사물함 전체를 채우고 있어, 문 SVG에 구멍이 있으면 색상이 바로 비친다.
- 포인트 배경(`--detail-hover`)은 문이 열리는 순간 중앙에서 스케일 업되며, 10px 인셋 안에서만 퍼져 테두리가 남는다.
- `clipPath`는 사각/원형 모두 열림·닫힘 상태에서 동일하게 유지되어 별도 확대 애니메이션이 없으며, 색상 전환만으로 레이어 변화를 표현한다.

## 팝업 트리거 흐름
- 문을 연 뒤 내부 영역을 클릭하면 `handleExpand`가 즉시 실행되어 확장 상태(`expanded`)로 전환된다.
- 드래그를 시작하거나 문을 다시 여닫는 동안에는 클릭이 무시되어 의도치 않은 확장을 방지한다.

## 상세 콘텐츠 등장 타이밍
- `detailContentVariants`가 배경 확장 직후(`delay: 0.25`)에 불투명도와 y 위치를 보간하여 등장.
- 열린 상태에서 문·배경·콘텐츠는 동일한 `open` 상태 키로 연동된다.
