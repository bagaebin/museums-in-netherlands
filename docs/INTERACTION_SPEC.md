# 인터랙션 상세 스펙

## 사물함 드래그
- 각 `Locker`는 `drag` 옵션을 가진 모션 `<div>`로 구현되어 포인터/터치 드래그를 지원한다.
- 드래그 중 위치가 `positions` 상태에 즉시 반영되어 관계 곡선이 실시간 업데이트된다.

## 치즈 곡선 생성/업데이트
- 두 사물함이 떨어질 때 `computePathPoints`가 시작/종점 사이에 부드러운 cubic Bézier를 생성한다.
- 시작점은 출발 사물함의 오른쪽 중앙, 종점은 대상 사물함의 왼쪽 중앙을 기본값으로 삼는다.
- 거리가 멀어질수록 제어점 오프셋(`curve = 80`)이 상대적으로 더 드러나 부드러운 "늘어짐" 효과가 발생한다.
- 관계선은 스테이지 실측 크기를 기반으로 `viewBox`를 동적으로 설정한 SVG(`width/height: 100%`) 위에 그려, 리사이즈나 레이아웃 전환 후에도 사물함 모서리와 정확히 맞닿는다.

## 관계 텍스트 등장 로직
- `estimateReveal`가 거리와 최대 임계값(기본 280px)을 비교해 라벨을 글자 단위로 절단한다.
- `textPath` 안에 잘린 문자열을 넣어, 곡선이 늘어날수록 더 많은 글자가 노출된다.

## 사물함 문 애니메이션
- 클릭으로 문을 연다(`onOpen`), 열린 동안에만 내부/배경/콘텐츠가 `open` 상태로 전환된다.
- `doorVariants`에 따라 `rotateY`를 -90°까지 회전하며, `transformOrigin: 'left center'`로 힌지 효과를 준다.
- 트랜지션은 spring(stiffness: 200, damping: 20)으로 설정해 메커니컬한 느낌을 강화.

## 내부 배경 확장 (clip-path)
- **사각형 inset**: `clipPath: 'inset(50% 50% 50% 50% round 16px)'`에서 시작해 `inset(0 0 0 0)`으로 확장.
- **원형 확장**: `clipPath: 'circle(0px at 50% 50%)'` → `circle(800px at 50% 50%)` 형태로 확장. 중심은 타일 중앙을 기본값으로 삼으나 커스텀 가능.
- 배경 확장은 문 회전보다 0.12초 지연되어 순차적으로 재생된다.

## 호버-투-팝업 흐름
- 문이 열린 상태(`isActive`)에서 같은 타일 위에 1.5초 동안 머무르면 타이머가 작동한다.
- 타이머가 완료되면 "held" 상태로 전환되며 배경 clip-path가 스테이지 대각선 길이까지 확장되고, `onExpand`가 호출되어 정보 팝업이 뜬다.
- 포인터 이탈, 드래그 시작, 혹은 비활성화 시 타이머가 취소되고 held 상태가 해제된다.

## 상세 콘텐츠 등장 타이밍
- `detailContentVariants`가 배경 확장 직후(`delay: 0.25`)에 불투명도와 y 위치를 보간하여 등장.
- 열린 상태에서 문·배경·콘텐츠는 동일한 `open` 상태 키로 연동된다.
